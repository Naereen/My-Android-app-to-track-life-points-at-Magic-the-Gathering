# TODO / Roadmap

This file is a life list of features to implement, bugs to fix, and improvements to make to the app.

Instead of using a proper issue tracker (e.g. GitHub Issues), I prefer to keep everything in this single file, easier to manage offline for a small personal project like this one.

---

## "Small" improvements to the usability of the app

- [x] Maximize to full screen on mobile devices: the "window" should take all the screen space, especially on the left/right sides

- [x] Write a `manifest.json` for PWA support

  - [x] It had MANY issues! I think I fixed them all now.
  - [x] Test installing the PWA on desktop (Windows, macOS, Linux)
  - [x] Test installing the PWA on Android devices
  - [ ] Test installing the PWA on Apple devices (iOS/iPadOS) - TODO: need an Apple device for that!

- [x] Turn off the zooming on mobile devices (pinch to zoom), as it breaks the UI
- [x] Turn off the feature of mobile devices to shut down the screen after some time of inactivity (it breaks the immersive experience of the games)

- [x] Turn off the feature of mobile devices to show the "download / share / print" menu on long click (it breaks the UI)

- [x] Reduce the vertical space taken by the "ressources" menu (mana/storm symbols) ==> NOPE
- [x] Increase the font-size of the names of the players, especially on mobile devices. DONE but don't do it too much!

-[ ] Add an animation showing the dice D6/D8/D10/etc rolling a little bit (like for 1 seconds, 6 different results appearing one after the other, before showing the final result). I don't know how to do that yet, but it would be a nice improvement for the randomizer feature!
- [ ] In the different menus (Randomizer, ManaStorm, etc.), the status effects should NOT be displayed for the player 1 (the one in the bottom).

## State saving improvements

- [x] Save the state in the local storage of the browser, so that reloading the page does not reset everything
  - [x] Save the app settings (number of players, starting life total, etc.)
  - [x] Save the players state (life totals, commander damage, etc.)
  - [x] Add a button to reset the local storage (clear saved settings and game state)

---

## DONE - Translating the app : 5 languages so far!

- [x] Add internationalization (i18n) support

  - [x] English (default)
  - [x] French (my native language)

- [x] Add more languages, if the technical framework is working well:

  - [x] Spanish
  - [x] German
  - [x] Italian
  - [x] Portuguese

- [x] Add a language selection menu in the settings dialog
  - [x] Reduce the size ot the labels of each language

---

## Bugs fixing:

- [x] Fix the bug where the "download / share / print" long click menu appear (on mobile devices)
- [ ] Fix a weird bug: when clicking fast on +1/-1 buttons, sometimes the life points are not updated correctly or the update continue to happen after releasing the button (worse with long clicks). I couldn't reproduce this bug anymore...

- [x] When throwing a die, the result is displayed too close to the die icon, spacen then a bit more!

### About the ServiceWorker.js script

```javascript
ServiceWorker registration failed: TypeError: ServiceWorker script at http://localhost:5173/service-worker.js for scope http://localhost:5173/ encountered an error during installation.
```

- [ ] There is a bug in the ServiceWorker.js script, which is generated by the Vite PWA plugin, but I don't know how to fix it yet. It doesn't seem to cause any issue for the app, but it is still a bug that should be fixed.

### The +2/-2 bug : should be fixed!

- [x] On mobile right now, when doing a very short touch (click) on the +1/-1 buttons, it sometimes adds/subtracts 2 points at once instead of 1 point at a time.

### The image background

- [x] The card search form seems to be broken sometimes: for instance, searching for *Jace Beleren* fails completely, even though there are many cards with this name in the Scryfall database.

- [ ] FIXME: Fix the bug where, when selecting a card as background, the image is not properly aligned and doesn't cover the entire background area (the top of the illustration should be aligned with the top of the background area, not cropping the card image if needed). I don't know how LifeTap does it, but I want a clean result like it.

### The 4-player secondary layout bug

- [x] In 4-player, when switching to the secondary layout (the "1 / 2 / 1" layout, the secondary layout mode (the one which is not 2 players on each side of the table)), some overlay panels are not displayed correctly.

- [x] In this layout, the "K.O." player dark overlay is displayed with a stronger "z-index" that it should have? So when a player is K.O.'d, the "K.O." overlay is displayed above all the other panels, including the "edit player" panel, which makes it impossible to edit a K.O.'d player. This bug is not present in the default layout (the "2 x 2" layout), only in the "1 / 2 / 1" layout.

---

## Player status and visualization improvements

- [x] Dead player icon: when a player is dead (life <= 0 or poison >= 10), show a skull icon next to their name, and gray out their life total

  - [x] Allow a player to not be dead if life is below 0 (e.g. with a "Lich's Mastery" effect), by adding a toggle for that feature, in the player edit dialog (playerwise)
  - [x] Allow negative life totals! (global setting)

- [x] Replace all `window.confirm` calls with custom modal dialogs integrated in the app, much nicer and prettier

- [x] Add a « about section » at the bottom of the settings menu, with:

  - [x] App version, name of the author, license
  - [x] Huge thank you to Michael Bourkas for the Lifetap app, which this is a personnal clone of
  - [x] Link to the GitHub repository
  - [ ] ?? Link to the Google Play Store page (when published)
  - [ ] ?? Link to a feedback form (Google Forms or similar)

- [x] Keep the small "medal" which indicates who started the game, during all the game (not only at the beginning)

- [x] Add a way to directly set the life total to a specific value, in the player pane. This is a new feature from LifeTap app!

- [x] Improve the text contrast of the life total number, especially on mobile devices (hard to read sometimes) : add a white shadow, and make it bold

- [x] In the PlayerDataModal.svelte, allow to scroll all the window, but keep the top always visible (fixed position). Do this by allowing the modal content to scroll, but not the modal header.
- [x] In the PlayerDataModal.svelte, add a third virtual "tab" (first two are Backgrounds and Colors), the "status_effects" should live in a separate pseudo tab view, to save some space?

- [x] In the PlayerDataModal.svelte, when selecting a card from Scryfall as background, after a search success, add a "Choose at random" button to pick a random card from the search results (instead of having to pick one by one). Also translate into fr/es/it/de the "Choose at random" text.

  - [x] If there is not yet a research result, clicking on this button shouldn't do nothing, it should just chose a random card from the full Scryfall database (just one random card from the entire database of cards/illustrations). The function is already implemented in the Scryfall utils (`randomCards`), just need to call it here when there is no search result yet.

- [x] Add a small section on the bottom of each player panel to show the current status effects on that player

  - [x] E.g. "Poisoned X/10", "Monarch", commander damage from the opponents, etc.
  - [x] Maybe even use small icons for that?
  - [x] List of boolean status effects (e.g. "Monarch"): Monarch, Initiative, Ascend, Day/Night, K.O.
  - [x] List of numeric status effects (e.g. "Poisoned 3/10"): Energy, Experience, Poison, Rad, Command Tax
  - [x] When clicking the "K.O." status effect, it should change the player's isDead status (gray out life total and skull icon)
  - [x] Improve this section visually, make it prettier with **nicer icons**
  - [x] Improve this section visually, make it prettier with **better layout**

- [ ] For the "Ring Bearer" and the "Speed" status, if the value reaches the maximum (4), the icon should switch from "ss-uncommon" to "ss-rare" (with a golden gradient), to show that the maximum has been reached. This is a nice visual feedback for these two status effects, as they have a maximum value of 4.

- [x] Improve the following boolean status effects, as only one player can have them at a time: Monarch Initiative. So when one player gets it, remove it from all the other players automatically.

- [x]Harder to track: implement the Commander Damage tracker (from each opponent).

  - [x] Move the localisation of the boolean/numerical status effects to this new section at the bottom of each player panel, or in the player's name (before/after), depending on whether the boolean information is unique among players (Monarch, Inicie) or not (Ascend, etc)
  - [ ] After, make this section visually appealing, make it prettier (nicer icons, better layout, etc.)

- [x] Add support for the poison counter: you can die to them!

  - [x] A +1/-1 button for poison counter, in the "commander damage" section, like the Lifetap app
  - [x] Add a way to increment/decrement poison counter with clicks on some buttons in the player panel (like for life total)
  - [x] Show the poison counter next to the life total, as soon as it is > 0
  - [x] When poison counter >= 10, the player is dead (show the skull icon, gray out their life total)

- [x] Increase font-size and change color to full-white with a shadow, for the -X/+X numbers that appear when changing life total, to improve visibility on mobile devices or on image backgrounds

- [x] Rotate to the left/right or 180deg the CONTENT of the panel showing the status effects, depending on the player's position, so that the text is always readable (not upside down or left/right).

- [x] Move the unique status effects (Monarch, Initiative) to the player name area, before/after the player's name, with a small icon, so that they are always visible and don't consume too much space in the status effect section at the bottom of the panel. This will also make it easier to implement the "rotate the content of the status effect section" feature, as there will be less text to rotate.

  - [ ] In the "status effect" panel in the PlayerDataModal.svelte, allow to double-click on any number damage entry to directly set the commander damage from this opponent to a specific value, instead of having to click many times on the +1/-1 buttons. This is a new feature, and it can be useful for Commander games! For instance, adding +54 energy counters, one by one, is long and boring.

- [x] Implement a way to know whose turn it is: store it in the app state, and add one button to proceed to the next player's turn

  - [x] A button to advance to the next player's turn, it should be located in the middle of the buttons for mana and randomizer?
  - [x] An independent button to go back to the previous player's turn would consume too much screen space, so just use a long click on the previous button, that will be enough!
  - [x] Show the current player's turn somewhere on the screen (prefix this player's name with "▶" or something like that)
  - [x] If a player is dead, skip their turn when going to the next player's turn

- [ ] Implement (after that) a timer for each turn (like in Lifetap app)

  - [ ] A way to set the timer duration (global setting)
  - [ ] Show the remaining time for the current player's turn
  - [ ] Haptic vibrate when the time is up
  - [ ] and sound an discrete tiny alarm when the time is up

- [ ] Improve the visibility of the "current player" (the one whose turn it is), maybe a glowing/golden border around their panel?

- [x] Implement two layouts for the four-players mode:

  - [x] The "1 / 2 / 1" layout, if players are seated on a round table
  - [x] The "2 x 2" layout, if players are seated on opposite sides of a rectangular table (classic mode for Two-Headed Giant mode, it is already implemented)

- [ ] (much later, I never play with 6 players) Implement two layouts for the six-players mode:
  - [ ] The "|::|" layout (one long | player on the left and the right, and in the middle like a Two-Headed Giant layout), if players are seated on a round table
  - [x] Default mode for 6-player right now: the ":::" layout (2 lines of 3 columns), if players are seated on opposite sides of a rectangular table (classic mode for Emperor mode, it is already implemented)

## Successfully build a working apk file

> Let's use [CapacitorJS.com](https://capacitorjs.com/) for that!

- [ ] Configure the build process to generate a working apk file
- [ ] Set up deployment to GitHub Releases so that the latest apk file is always available for download
- [ ] Test it on my devices
- [ ] Publish it as a beta on the Google Play Store

BUUUUT so far I'm testing on the PWA installed from Chrome on Android, which works pretty well already!

I've also tried using the PWA Builder website, but the generated apk file couldn't be installed on my phone.

## Better menus and dialogs

- [x] Confirmation menus overhaul

  - [x] Improve the "reset game" dialog
  - [x] Improve the "new player" dialog
  - [x] Improve the "edit player" dialog

- [x] Implement the "settings" dialog
- [x] Implement the "about" dialog

- [x] Improve the spacing of the mana/storm count : reduce the size of the mana symbols?

- [ ] TODO: When clicking on the "player configuration" menu, rotate it -90deg/90deg/180deg depending on the player position, so that the menu is always readable (not upside down or left/right). I expect this feature to be hard to implement...

---

## Very cool features from "Lifetap" app to implement

- [x] Custom Player backgrounds

  - [x] With a simple color picker : one color of mana, and that's it
  - [x] If clicking on a color after it is already selected, deselect it (go back to default background)
  - [x] With a color gradient picker: two colors of mana, gradient between the two. Works with any number of colors (from 1 to 12).

- [x] Even better custom Player backgrounds

  - [x] With a card search to pick a card as background
  - [x] Align the top of the illustration with the top of background area (crop the card image if needed)
  - [x] Works fine for cards with different illustrations for the same name and edition
  - [x] Add a "clear background" button to go back to default background; also when picking a color, if clicking again on a color while an image background had been selected before, remove the image background and go back to the color background
  - [x] When loading the app without any settings saved (new fresh session) or when resetting the settings, randomly assign a background to each player (a simple random choice of two colors)
    - [x] NOPE: Later? Randomly assign a background image from a predefined list of cards (e.g. the Planeswalker from MTG) - I already added a "random background" button!
  - [ ] Allow partners and backgrounds and all pairs of legendary commanders. XXX: Not yet, it's too complicated to manage a background with two illustrations side by side properly.

- [x] Improve the "search background" feature: after searching and choosing a background image, the "search background" dialog should keep in memory the chosen image, and display its status of "chosen image" in the result list.
  - [x] This information about the chosen background should always be display in the "search background" tab: if player number 1/2/3/4/5/6 has already chosen a background, when opening again the "search background" tab, the chosen background should be displayed (and indicated as "chosen") in the search result list by default, and also when searching for another card, if the chosen background is in the search result, it should be indicated as "chosen" in the search result list.
    - [x] Improve this feature of the "memory aware" "search background" panel, it should keep in memory the `artist` name and the `set_name` of the last chosen background image, to display it when the "search background" panel is opened again
  - [x] By default, when opening the "search background" panel, the search button/input form should be filled with the name of the player! That's fun, and it can help to find a card that matches the player's name (e.g. if the player is named "Jace", they can search for "Jace" and find all the Jace planeswalkers, which are pretty cool as backgrounds!)

- [x] Commander damage type tracking, in a simple and visual way, with a small icon for each opponent, and a number for the commander damage received from this opponent. It is a new feature from the Lifetap app, and it is very useful for Commander games!

  - [x] In the "Commander damage" panel in the PlayerDataModal.svelte, allow to double-click on a commander damage entry to directly set the commander damage from this opponent to a specific value, instead of having to click multiple times on the +1/-1 buttons. This is a new feature, and it can be useful for Commander games!

  - [ ] Move the "Commander damage" section to its onwn tab in the PlayerDataModal.svelte, instead of being in the bottom/end "Status effects" tab, as it is a very important information for Commander games, and it deserves to be more visible and easier to access.

- [ ] Multiplayer game modes outside EDH mode (Two-Headed Giant, etc.)
  - [ ] Add a setting in the global setting, to switch to Two-Headed Giant mode, which will change the layout to a "1 vs 1" layout, with max Poison counters changing from 10 to 15. This is a very popular multiplayer format, and it is supported by the Lifetap app, but not yet implemented here.

## Variants already existing in Lifetap but not yet implemented here

- [ ] PlaneChase support (background changes every turn or on a click)
- [ ] Archenemy support (extra damage tracking)

---

## New features to implement

Random ideas:

- [ ] Sound effects on button clicks (big life up/down, big commander damage up/down, K.O. of a player, victory of the last remaining at the table, etc.). Should be enable by default, but should be possible to disable them from the settings!
- [x] Haptic feedback on button clicks (life up/down, commander damage up/down, etc.). TODO: Needs more testing on mobile devices, especially on Apple devices, as I don't have any for testing. It is enabled by default, and it is possible to disable it from the settings!

Active turn indicator:

- [ ] even if the timer of the current turn is not shown (it should be possible to enable/disable it in the settings), the app could count the time of each turn in the background, and display some statistics at the end: Akroma played for 19% of the time of the game, while Cho-Manno played for 32% of the total time.
- [ ] implement a timer that can be shown and decreases / increases (which is best?). Add a discrete but long vibration when the timer reaches 0 seconds (if decreasing) or X minutes (if increasing).

Nope:

- [ ] ~~Customizable button sizes (small, medium, large)~~
- [ ] ~~Customizable layout options (compact mode, expanded mode)~~
- [x] ~~Night mode / dark theme~~
- [ ] ~~Customizable fonts (font family, font size)~~

## Additional visualizations: dungeons (initiative, etc), The Ring emblem, your speed

- [x] Add the "Ring Bearer" emblem (from Lord of the Rings) as a status effect that can be tracked for each player, with a small icon. It is a special status that can be given to one player at a time, and it has some special rules. The icon for this status effect should be the `TheRingerBearer.svelte` object. The number associated with this status is between 0 and 4, and starts at 0. It cannot go down in the rules of the MTG game, but it should be possible to decrease it in the app (in case of a mistake). It is _not_ a unique status, every player has his own "the Ring Bearer" count, from 0 to 4.

- [x] Add the "Start your Engine / Your Speed" emblem (from Aetherdrift) as a status effect that can be tracked for each player, with a small icon. It is a special status that can be given to one player at a time, and it has some special rules. The icon for this status effect should be the `StartYourEngineSpeed.svelte` object. The number associated with this status is between 0 and 4, and starts at 0. It cannot go down in the rules of the MTG game, but it should be possible to decrease it in the app (in case of a mistake). It is _not_ a unique status, every player has his own "Start your Engine / Your Speed" count, from 0 to 4.

- [ ] Additional visualizations: be able to see, on a click in the menu, The Ring bearer emblem (Lord of the Rings) : <https://scryfall.com/card/tltr/H13/the-ring-the-ring-tempts-you?front> and <https://scryfall.com/card/tltr/H13/the-ring-the-ring-tempts-you?back>
- [ ] Additional visualizations: be able to see, on a click in the menu, Your speed (Aetherdrift) : 0/1/2/3/4(max) <https://scryfall.com/card/tdft/14/start-your-engines!-max-speed?front> and <https://scryfall.com/card/tdft/14/start-your-engines!-max-speed?back>

- [ ] Additional visualizations: be able to see, on a click and a searh in the menu, any dungeon or Planeswalker's emblem, by a search from Scryfall

- [ ] Additional visualizations: be able to see, on a click in the menu, dungeons (initiative, etc) <https://scryfall.com/search?q=t%3Adungeon>
- [ ] Additional visualizations: the dungeon made by some friend over at Colmar

## Variants to implement here, not existing in Lifetap

- [ ] The "scry0 / scry1 scry1 / scry2" special rule for turn 1 in 4-player mode, or ".. scry 3" for 5-player mode
- [ ] 4 Seasons emblems support (track the common emblem, and show it on the board somewhere)
- [ ] Vanguard support (special cards that modify starting life total and starting hand, and give static abilities)
- [ ] Shogun / Treachery support (hidden role to check once when the game starts, and hidden after that)

## Customize the probabilities of whose player starts the game

- [ ] Allow to customize the probabilities of each player starting the game (instead of uniform distribution)
  - [ ] E.g. Player 1 has 50% chance to start, Player 2 has 25%, Player 3 has 15%, Player 4 has 10%
  - [ ] Add a way to set these probabilities in the settings dialog

---

## Dream/weird features, they'll never happen!

- [ ] Game history and undo functionality
- [ ] Enhanced statistics and analytics, à la Mythic.Tools
- [ ] Cloud sync and backup, à la Mythic.Tools
- [ ] Multiplayer online mode (connect with friends over the internet)
- [ ] Customizable themes and UI options

---

## On the development side

- [ ] Automated tests? I literally have no idea how to write tests for a graphical web app (SvelteKit app). Thus, I should/could learn!
